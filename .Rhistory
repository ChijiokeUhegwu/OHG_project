resfinder_fulldata %>%
# Step 1: Count unique isolates per year per drug class
distinct(sample_id, collection_year, drug_class_group) %>%
count(collection_year, drug_class_group, name = "class_count") %>%
# Step 2: Compute total number of isolates per year
left_join(
resfinder_fulldata %>%
distinct(sample_id, collection_year) %>%
count(collection_year, name = "total_isolates"),
by = "collection_year"
) %>%
# Step 3: Normalize to proportion per year
mutate(prop = class_count / total_isolates) %>%
# Step 4: Plot temporal trends
ggplot(aes(x = collection_year, y = prop, color = drug_class_group)) +
geom_line(size = 1) +
geom_point() +
labs(
x = "Year of collection",
y = "Proportion of isolates",
color = "Drug class group",
title = "Temporal trends in antimicrobial resistance classes (normalized)"
) +
theme_minimal() +
theme(
panel.grid = element_blank(),
plot.title = element_text(size = 12, face = "bold", hjust = 0.2)
)
# Instead of plotting the raw year counts, it is best to normalize the data by number of isolates per year to account for where the sampling differs by year.
time_trend <- resfinder_fulldata  %>%
distinct(sample_id, collection_year, drug_class_group) %>%
count(collection_year, drug_class_group)
# Visualization
ggplot(time_trend, aes(x = collection_year, y = n, color = drug_class_group)) +
geom_line() +
geom_point() +
labs(
x = "Year of collection",
y = "Resistance determinant count",
title = "Figure 8: Temporal trends in antimicrobial resistance classes",
color = "Drug class group"
) +
theme_minimal() +
theme(panel.grid = element_blank(),
plot.title = element_text(size = 12, face = "bold", hjust = 0.2)
)
time_trend <- resfinder_fulldata %>% distinct(sample_id, collection_year, drug_class_group) %>% count(collection_year, drug_class_group) # Visualization ggplot(time_trend, aes(x = collection_year, y = n, color = drug_class_group)) + geom_line() + geom_point() + labs( x = "Year of collection", y = "Resistance determinant count", title = "Figure 8: Temporal trends in antimicrobial resistance classes", color = "Drug class group" ) + theme_minimal() + theme(panel.grid = element_blank(), plot.title = element_text(size = 12, face = "bold", hjust = 0.2) )
resfinder_fulldata %>%
distinct(sample_id, collection_year, drug_class_group) %>%
count(collection_year, drug_class_group, name = "class_count") %>%
left_join(
resfinder_fulldata %>%
distinct(sample_id, collection_year) %>%
count(collection_year, name = "total_isolates"),
by = "collection_year"
) %>%
mutate(prop = class_count / total_isolates) %>%
ggplot(aes(x = collection_year, y = prop, color = drug_class_group)) +
geom_line(size = 1) +
geom_point(size = 2) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
x = "Year of collection",
y = "Percentage of isolates",
color = "Drug class group",
title = "Temporal trends in antimicrobial resistance classes"
) +
theme_minimal() +
theme(
panel.grid = element_blank(),
plot.title = element_text(size = 12, face = "bold", hjust = 0.2)
)
resfinder_fulldata %>%
# Step 1: Count unique isolates per year per drug class
distinct(sample_id, collection_year, drug_class_group) %>%
count(collection_year, drug_class_group, name = "class_count") %>%
# Step 2: Compute total number of isolates per year
left_join(
resfinder_fulldata %>%
distinct(sample_id, collection_year) %>%
count(collection_year, name = "total_isolates"),
by = "collection_year"
) %>%
# Step 3: Normalize to proportion per year
mutate(prop = class_count / total_isolates) %>%
# Step 4: Plot temporal trends
ggplot(aes(x = collection_year, y = prop, color = drug_class_group)) +
geom_line(size = 1) +
geom_point(size = 2) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
x = "Year of collection",
y = "Percentage of isolates",
color = "Drug class group",
title = "Figure 8: Temporal trends in antimicrobial resistance classes"
) +
theme_minimal() +
theme(
panel.grid = element_blank(),
plot.title = element_text(size = 12, face = "bold", hjust = 0.2)
)
# Instead of plotting the raw year counts, it is best to normalize the data by number of isolates per year to account for the difference in the sampling difference by year.
resfinder_fulldata %>%
# Step 1: Count unique isolates per year per drug class
distinct(sample_id, collection_year, drug_class_group) %>%
count(collection_year, drug_class_group, name = "class_count") %>%
# Step 2: Compute total number of isolates per year
left_join(
resfinder_fulldata %>%
distinct(sample_id, collection_year) %>%
count(collection_year, name = "total_isolates"),
by = "collection_year"
) %>%
# Step 3: Normalize to proportion per year
mutate(prop = class_count / total_isolates) %>%
# Step 4: Plot temporal trends
ggplot(aes(x = collection_year, y = prop, color = drug_class_group)) +
geom_line(size = 1) +
geom_point(size = 2) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
x = "Year of collection",
y = "Percentage of isolates",
color = "Drug class group",
title = "Figure 8: Temporal trends in antimicrobial resistance classes"
) +
scale_fill_viridis_d(option = "D") +
theme_minimal() +
theme(
panel.grid = element_blank(),
plot.title = element_text(size = 12, face = "bold", hjust = 0.2)
)
# Instead of plotting the raw year counts, it is best to normalize the data by number of isolates per year to account for the difference in the sampling difference by year.
resfinder_fulldata %>%
# Step 1: Count unique isolates per year per drug class
distinct(sample_id, collection_year, drug_class_group) %>%
count(collection_year, drug_class_group, name = "class_count") %>%
# Step 2: Compute total number of isolates per year
left_join(
resfinder_fulldata %>%
distinct(sample_id, collection_year) %>%
count(collection_year, name = "total_isolates"),
by = "collection_year"
) %>%
# Step 3: Normalize to proportion per year
mutate(prop = class_count / total_isolates) %>%
# Step 4: Plot temporal trends
ggplot(aes(x = collection_year, y = prop, color = drug_class_group)) +
geom_line(size = 1) +
geom_point(size = 2) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
x = "Year of collection",
y = "Percentage of isolates",
color = "Drug class group",
title = "Figure 8: Temporal trends in antimicrobial resistance classes"
) +
scale_color_viridis_d(option = "D") +
theme_minimal() +
theme(
panel.grid = element_blank(),
plot.title = element_text(size = 12, face = "bold", hjust = 0.2)
)
# Instead of plotting the raw year counts, it is best to normalize the data by number of isolates per year to account for the difference in the sampling difference by year.
resfinder_fulldata %>%
# Step 1: Count unique isolates per year per drug class
distinct(sample_id, collection_year, drug_class_group) %>%
count(collection_year, drug_class_group, name = "class_count") %>%
# Step 2: Compute total number of isolates per year
left_join(
resfinder_fulldata %>%
distinct(sample_id, collection_year) %>%
count(collection_year, name = "total_isolates"),
by = "collection_year"
) %>%
# Step 3: Normalize to proportion per year
mutate(prop = class_count / total_isolates) %>%
mutate(collection_year = ifelse(collection_year %in% c(2021, 2022),
"2021-2022",
as.character(collection_year))) %>%
# Step 4: Plot temporal trends
ggplot(aes(x = collection_year, y = prop, color = drug_class_group)) +
geom_line(size = 1) +
geom_point(size = 2) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
x = "Year of collection",
y = "Percentage of isolates",
color = "Drug class group",
title = "Figure 8: Temporal trends in antimicrobial resistance classes"
) +
scale_color_viridis_d(option = "D") # to modify the aes color for consistency +
theme_minimal() +
theme(
panel.grid = element_blank(),
plot.title = element_text(size = 12, face = "bold", hjust = 0.2)
)
# Instead of plotting the raw year counts, it is best to normalize the data by number of isolates per year to account for the difference in the sampling difference by year.
resfinder_fulldata %>%
# Step 1: Count unique isolates per year per drug class
distinct(sample_id, collection_year, drug_class_group) %>%
count(collection_year, drug_class_group, name = "class_count") %>%
# Step 2: Compute total number of isolates per year
left_join(
resfinder_fulldata %>%
distinct(sample_id, collection_year) %>%
count(collection_year, name = "total_isolates"),
by = "collection_year"
) %>%
# Step 3: Normalize to proportion per year
mutate(prop = class_count / total_isolates) %>%
mutate(collection_year = ifelse(collection_year %in% c(2021, 2022),
"2021-2022",
as.character(collection_year))) %>%
# Step 4: Plot temporal trends
ggplot(aes(x = collection_year, y = prop, color = drug_class_group)) +
geom_line(size = 1) +
geom_point(size = 2) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
x = "Year of collection",
y = "Percentage of isolates",
color = "Drug class group",
title = "Figure 8: Temporal trends in antimicrobial resistance classes"
) +
scale_color_viridis_d(option = "D") # to modify the aes color for consistency +
theme_minimal() +
theme(
panel.grid = element_blank(),
plot.title = element_text(size = 12, face = "bold", hjust = 0.2)
)
# Instead of plotting the raw year counts, it is best to normalize the data by number of isolates per year to account for the difference in the sampling difference by year.
resfinder_fulldata %>%
mutate(collection_year = ifelse(collection_year %in% c(2021, 2022),
"2021-2022",
as.character(collection_year))) %>%
# Step 1: Count unique isolates per year per drug class
distinct(sample_id, collection_year, drug_class_group) %>%
count(collection_year, drug_class_group, name = "class_count") %>%
# Step 2: Compute total number of isolates per year
left_join(
resfinder_fulldata %>%
distinct(sample_id, collection_year) %>%
count(collection_year, name = "total_isolates"),
by = "collection_year"
) %>%
# Step 3: Normalize to proportion per year
mutate(prop = class_count / total_isolates) %>%
# Step 4: Plot temporal trends
ggplot(aes(x = collection_year, y = prop, color = drug_class_group)) +
geom_line(size = 1) +
geom_point(size = 2) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
x = "Year of collection",
y = "Percentage of isolates",
color = "Drug class group",
title = "Figure 8: Temporal trends in antimicrobial resistance classes"
) +
scale_color_viridis_d(option = "D") # to modify the aes color for consistency +
# Instead of plotting the raw year counts, it is best to normalize the data by number of isolates per year to account for where the sampling differs by year.
time_trend <- resfinder_fulldata  %>%
distinct(sample_id, collection_year, drug_class_group) %>%
count(collection_year, drug_class_group)
# Visualization
ggplot(time_trend, aes(x = collection_year, y = n, color = drug_class_group)) +
geom_line() +
geom_point() +
labs(
x = "Year of collection",
y = "Resistance determinant count",
title = "Figure 8: Temporal trends in antimicrobial resistance classes",
color = "Drug class group"
) +
theme_minimal() +
theme(panel.grid = element_blank(),
plot.title = element_text(size = 12, face = "bold", hjust = 0.2)
)
# Instead of plotting the raw year counts, it is best to normalize the data by number of isolates per year to account for the difference in the sampling difference by year.
resfinder_fulldata %>%
# Step 0: Collapse years first
mutate(
collection_year = ifelse(
collection_year %in% c(2021, 2022),
"2021-2022",
as.character(collection_year)
)
) %>%
# Step 1: Count unique isolates per year per drug class
distinct(sample_id, collection_year, drug_class_group) %>%
count(collection_year, drug_class_group, name = "class_count") %>%
# Step 2: Compute total isolates per (collapsed) year
left_join(
resfinder_fulldata %>%
mutate(
collection_year = ifelse(
collection_year %in% c(2021, 2022),
"2021-2022",
as.character(collection_year)
)
) %>%
distinct(sample_id, collection_year) %>%
count(collection_year, name = "total_isolates"),
by = "collection_year"
) %>%
# Step 3: Compute proportion
mutate(prop = class_count / total_isolates) %>%
# Step 4: Plot
ggplot(aes(x = collection_year, y = prop, color = drug_class_group)) +
geom_line(size = 1) +
geom_point(size = 2) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
scale_color_viridis_d(option = "D") +
labs(
x = "Year of collection",
y = "Percentage of isolates",
color = "Drug class group",
title = "Figure 8: Temporal trends in antimicrobial resistance classes"
) +
theme_minimal() +
theme(
panel.grid = element_blank(),
plot.title = element_text(size = 12, face = "bold", hjust = 0.2)
)
# Instead of plotting the raw year counts, it is best to normalize the data by number of isolates per year to account for the difference in the sampling difference by year.
resfinder_fulldata %>%
# Step 1: Count unique isolates per year per drug class
distinct(sample_id, collection_year, drug_class_group) %>%
count(collection_year, drug_class_group, name = "class_count") %>%
# Step 2: Compute total number of isolates per year
left_join(
resfinder_fulldata %>%
distinct(sample_id, collection_year) %>%
count(collection_year, name = "total_isolates"),
by = "collection_year"
) %>%
# Step 3: Normalize to proportion per year
mutate(prop = class_count / total_isolates) %>%
# Step 4: Plot temporal trends
ggplot(aes(x = collection_year, y = prop, color = drug_class_group)) +
geom_line(size = 1) +
geom_point(size = 2) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
x = "Year of collection",
y = "Percentage of isolates",
color = "Drug class group",
title = "Figure 8: Temporal trends in antimicrobial resistance classes"
) +
scale_color_viridis_d(option = "D") # to modify the aes color for consistency +
theme_minimal() +
theme(
panel.grid = element_blank(),
plot.title = element_text(size = 12, face = "bold", hjust = 0.2)
)
# Instead of plotting the raw year counts, it is best to normalize the data by number of isolates per year to account for the difference in the sampling difference by year.
resfinder_fulldata %>%
# Step 1: Count unique isolates per year per drug class
distinct(sample_id, collection_year, drug_class_group) %>%
count(collection_year, drug_class_group, name = "class_count") %>%
# Step 2: Compute total number of isolates per year
left_join(
resfinder_fulldata %>%
distinct(sample_id, collection_year) %>%
count(collection_year, name = "total_isolates"),
by = "collection_year"
) %>%
# Step 3: Normalize to proportion per year
mutate(prop = class_count / total_isolates) %>%
# Step 4: Plot temporal trends
ggplot(aes(x = collection_year, y = prop, color = drug_class_group)) +
geom_line(size = 1) +
geom_point(size = 2) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
x = "Year of collection",
y = "Percentage of isolates",
color = "Drug class group",
title = "Figure 8: Temporal trends in antimicrobial resistance classes"
) +
scale_color_viridis_d(option = "D") # to modify the aes color for consistency +
theme_minimal() +
theme(
panel.grid = element_blank(),
plot.title = element_text(size = 12, face = "bold", hjust = 0.2)
)
org_source <- resfinder_fulldata %>%
distinct(sample_id, organism_group, isolation_source) %>%
count(organism_group, isolation_source)
ggplot(org_source, aes(x = isolation_source, y = n, fill = organism_group)) +
geom_col(position = "dodge") +
labs(
x = "Isolation Source",
y = "Number of isolates",
fill = "Organism",
title = "Distribution of E. coli and Shigella across One Health sources"
) +
theme_bw()
mdr_df <- resfinder_fulldata %>%
distinct(sample_id, drug_class_group, isolation_source) %>%
count(sample_id, isolation_source, name = "n_classes") %>%
mutate(MDR = ifelse(n_classes >= 3, "MDR", "Non-MDR"))
mdr_df
mdr_df <- resfinder_fulldata %>%
distinct(sample_id, drug_class_group, isolation_source) %>%
count(sample_id, isolation_source, name = "n_classes") %>%
mutate(MDR = ifelse(n_classes >= 3, "MDR", "Non-MDR"))
# MDR prevalence by source
mdr_summary <- mdr_df %>%
count(isolation_source, MDR)
ggplot(mdr_summary, aes(x = isolation_source, y = n, fill = MDR)) +
geom_col(position = "dodge") +
labs(
x = "Isolation Source",
y = "Proportion",
fill = "MDR status",
title = "Proportion of multidrug-resistant isolates by source"
) +
theme_bw()
mdr_df <- resfinder_fulldata %>%
distinct(sample_id, drug_class_group, isolation_source) %>%
count(sample_id, isolation_source, name = "n_classes") %>%
mutate(MDR = ifelse(n_classes >= 3, "MDR", "Non-MDR"))
# MDR prevalence by source
mdr_summary <- mdr_df %>%
count(isolation_source, MDR)
ggplot(mdr_summary, aes(x = isolation_source, y = n, fill = MDR)) +
geom_col(position = "dodge") +
labs(
x = "Isolation Source",
y = "Proportion",
fill = "MDR status",
title = "FIgure 9: Proportion of multidrug-resistant isolates by source"
) +
scale_fill_viridis_d(option = "D") + # to modify the aes color for consistency
theme_minimal() +
theme(panel.grid = element_blank(),
plot.title = element_text(size = 12, face = "bold", hjust = 0.2)
mdr_df <- resfinder_fulldata %>%
distinct(sample_id, drug_class_group, isolation_source) %>%
count(sample_id, isolation_source, name = "n_classes") %>%
mutate(MDR = ifelse(n_classes >= 3, "MDR", "Non-MDR"))
# MDR prevalence by source
mdr_summary <- mdr_df %>%
count(isolation_source, MDR)
ggplot(mdr_summary, aes(x = isolation_source, y = n, fill = MDR)) +
geom_col(position = "dodge") +
labs(
x = "Isolation Source",
y = "Proportion",
fill = "MDR status",
title = "Figure 9: Proportion of multidrug-resistant isolates by source"
) +
scale_color_viridis_d(option = "D") + # to modify the aes color for consistency
theme_minimal() +
theme(panel.grid = element_blank(),
plot.title = element_text(size = 12, face = "bold", hjust = 0.2)
mdr_df <- resfinder_fulldata %>%
distinct(sample_id, drug_class_group, isolation_source) %>%
count(sample_id, isolation_source, name = "n_classes") %>%
mutate(MDR = ifelse(n_classes >= 3, "MDR", "Non-MDR"))
# MDR prevalence by source
mdr_summary <- mdr_df %>%
count(isolation_source, MDR)
ggplot(mdr_summary, aes(x = isolation_source, y = n, fill = MDR)) +
geom_col(position = "dodge") +
labs(
x = "Isolation Source",
y = "Proportion",
fill = "MDR status",
title = "Figure 9: Proportion of multidrug-resistant isolates by source"
) +
theme(panel.grid = element_blank(),
plot.title = element_text(size = 12, face = "bold", hjust = 0.2)
mdr_df <- resfinder_fulldata %>%
distinct(sample_id, drug_class_group, isolation_source) %>%
count(sample_id, isolation_source, name = "n_classes") %>%
mutate(MDR = ifelse(n_classes >= 3, "MDR", "Non-MDR"))
# MDR prevalence by source
mdr_summary <- mdr_df %>%
count(isolation_source, MDR)
ggplot(mdr_summary, aes(x = isolation_source, y = n, fill = MDR)) +
geom_col(position = "dodge") +
labs(
x = "Isolation Source",
y = "Proportion",
fill = "MDR status",
title = "Figure 9: Proportion of multidrug-resistant isolates by source"
) +
scale_color_viridis_d(option = "D") + # to modify the aes color for consistency
theme_minimal() +
theme(panel.grid = element_blank(),
plot.title = element_text(size = 12, face = "bold", hjust = 0.2))
mdr_df <- resfinder_fulldata %>%
distinct(sample_id, drug_class_group, isolation_source) %>%
count(sample_id, isolation_source, name = "n_classes") %>%
mutate(MDR = ifelse(n_classes >= 3, "MDR", "Non-MDR"))
# MDR prevalence by source
mdr_summary <- mdr_df %>%
count(isolation_source, MDR)
ggplot(mdr_summary, aes(x = isolation_source, y = n, fill = MDR)) +
geom_col(position = "dodge") +
labs(
x = "Isolation Source",
y = "Proportion",
fill = "MDR status",
title = "Figure 9: Proportion of multidrug-resistant isolates by source"
) +
scale_fill_viridis_d(option = "D") + # to modify the aes color for consistency
theme_minimal() +
theme(panel.grid = element_blank(),
plot.title = element_text(size = 12, face = "bold", hjust = 0.2))
